<!DOCTYPE html>
<html lang="en">
<head>
        <title>Oh My Heart - javascript</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href=".././theme/css/main.css" type="text/css" />
        
        <link href="http://aezell.github.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Oh My Heart Atom Feed" />
        
        

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href=".././css/ie.css"/>
                <script src=".././js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href=".././css/ie6.css"/><![endif]-->

</head>

<body id="index" class="home">

        <header id="banner" class="body">
                <h1><a href="../.">Oh My Heart </a></h1>
                <nav><ul>
                
                
                
                
                
                    <li ><a href=".././category/personal.html">personal</a></li>
                
                    <li ><a href=".././category/technical.html">technical</a></li>
                
                </ul></nav>
        </header><!-- /#banner -->
                

            

        
        
            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href=".././/2012/10/13/javascript-mvc-ember-backbone/">Failing at Javascript <span class="caps">MVC</span> with Ember.js and&nbsp;Backbone.js</a></h1> 
                    <footer class="post-info">
        <abbr class="published" title="2012-10-13T00:00:00">
                Sat 13 October 2012
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/alex-ezell.html">Alex Ezell</a>
        </address>
        
<p>In <a href=".././category/technical.html">technical</a>. </p>
<p>tags: <a href=".././tag/javascript.html">javascript</a><a href=".././tag/mvc.html">mvc</a><a href=".././tag/emberjs.html">ember.js</a><a href=".././tag/backbonejs.html">backbone.js</a></p>


</footer><!-- /.post-info --><p>I recently started work on an app using a third-party <span class="caps">API</span> that deals with posting to and monitoring social networks. Given that the app was going to be a single-page affair and was strictly only going to be using this third-party <span class="caps">API</span>, I thought it would be a good chance to dive into some Javascript <span class="caps">MVC</span>&nbsp;frameworks.</p>
<p>After a quick survey of my coworkers, all of whom are much more adept at Javascript than I, I decided to try Ember.js and Backbone.js. This blog serves to detail what I was trying to do and how much I failed at progress. While, as of this writing, I have a VanillaJS and jQuery based app that does exactly what I need it to do, I think my failures and roadblocks with Ember.js and Backbone.js might be&nbsp;interesting.</p>
<h2>The&nbsp;Goal</h2>
<p>Let me set out my goal, so you&#8217;ll have some context to understand better why I did what I did and maybe even be able to see me going wrong as it&nbsp;happens.</p>
<p>At work, we have a Django app and I was planning on dropping my Javascript <span class="caps">MVC</span> app into a content area with the rest of the page around it generated by the Javascript&nbsp;application. </p>
<p>My primary data source would be the third-party <span class="caps">API</span> mentioned above. It&#8217;s a pretty straightforward <span class="caps">REST</span> <span class="caps">API</span> that speaks <span class="caps">JSON</span> and does it in a pretty consistent way. I had already written a Python wrapper around the <span class="caps">API</span>, so I knew what to expect with my data access&nbsp;methods.</p>
<p>The page as concepted was a one-page app with mostly read views and only one action that would actually need to <span class="caps">POST</span> to the <span class="caps">API</span> and create new&nbsp;data.</p>
<p>Seemed really simple. I also have a&nbsp;deadline.</p>
<h2>The First&nbsp;Problem</h2>
<p>Given that Ember.js requires Handlebars.js and Backbone.js works really well with it, I had to figure out how to get my Handlebars templates into a Django&nbsp;template.</p>
<p>I ended up finding <a href="https://gist.github.com/3886746">this template tag</a> which let me wrap my Handlebars templates so that Django wouldn&#8217;t try to evaluate anything inside of the&nbsp;tag.</p>
<p>Problem&nbsp;solved.</p>
<h2>My Experience with&nbsp;Ember.js</h2>
<p>Like a good programmer should, I first started by reading <a href="http://emberjs.com/documentation/">the documentation for Ember.js</a>. But, like a lot of documentation, it is dense and not terribly good at painting the big&nbsp;picture.</p>
<p>I was excited to find that they had a <a href="http://emberjs.com/guides/">guides section</a> but frustrated that those guides weren&#8217;t exactly of the tutorial&nbsp;type.</p>
<p>Next, I was pointed to <a href="http://trek.github.com/">this essay by Trek Glowacki</a> as a great resource for how to build an Ember.js app. And that it most certainly&nbsp;is. </p>
<p>However, it&#8217;s a step-by-step guide to build a massive app completely in Ember.js. It does not stop to answer questions about how these new concept might or might not match up with concepts with which the reader may be&nbsp;familiar.</p>
<p>That is, it&#8217;s a tutorial that requires you to forget everything else you know. This is a great way to truly learn something new, but it&#8217;s not so good for productivity under a&nbsp;deadline.</p>
<h3>The First&nbsp;Code</h3>
<p>With the first code I wrote, I attempted to follow Trek&#8217;s guide to the letter. I had outlets and routes and felt good about the structure I was laying out. However, it didn&#8217;t really seem to&nbsp;work.</p>
<p><a href="http://jsfiddle.net/veDjq/">Here&#8217;s a look at what the code basically looked like at this&nbsp;point.</a></p>
<p>The <span class="caps">HTML</span> that corresponds to the Javascript in the link above is lost in time. However, the issue was that I was having problems with understanding how the outlets connected to the app and the notion that Trek&#8217;s guides seems to assume that the whole page is controlled by the&nbsp;Javascript.</p>
<p>Additionally, I was having issues with how the callbacks that are happening wouldn&#8217;t be finished in time for the code that needed to use their&nbsp;results. </p>
<p>You&#8217;ll remember the third-part <span class="caps">API</span> I talked about. It requires that a signature string be created and appended to every <span class="caps">API</span>&nbsp;call. </p>
<div class="codehilite"><pre><span class="n">App</span><span class="p">.</span><span class="n">Signature</span> <span class="p">=</span> <span class="n">Ember</span><span class="p">.</span><span class="n">Object</span><span class="p">.</span><span class="n">extend</span><span class="p">();</span>
<span class="n">App</span><span class="p">.</span><span class="n">Signature</span><span class="p">.</span><span class="n">reopenClass</span><span class="p">({</span>
    <span class="n">signature</span><span class="p">:</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
    <span class="n">getSignature</span><span class="p">:</span> <span class="k">function</span><span class="p">(){</span>
        $<span class="p">.</span><span class="n">ajax</span><span class="p">({</span>
            <span class="n">async</span><span class="p">:</span> <span class="n">false</span><span class="p">,</span>
            <span class="n">url</span><span class="p">:</span> <span class="s">&#39;/auth/&#39;</span><span class="p">,</span>
            <span class="n">success</span><span class="p">:</span> <span class="k">function</span><span class="p">(</span><span class="n">response</span><span class="p">){</span>
                <span class="n">this</span><span class="p">.</span><span class="n">signature</span> <span class="p">=</span> <span class="n">response</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">});</span>
        <span class="k">return</span> <span class="n">this</span><span class="p">.</span><span class="n">signature</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></div>


<p>Turns out, I didn&#8217;t know anything about promises or deferreds. This was one of the great things I learned when I asked <a href="http://stackoverflow.com/questions/12732692/forcing-ember-to-wait-for-value-from-an-ajax-request">this question on Stack Overflow</a>. This is clearly not an Ember problem, but it was something great to&nbsp;learn.</p>
<p>I quickly realized that the outlets and routes wouldn&#8217;t work for me, mostly because it seemed like my simple app didn&#8217;t need them. They were just clouding my already muddled understanding of what I was&nbsp;doing.</p>
<h3>The Second&nbsp;Code</h3>
<p>Through some trials and tribulations, I eventually was able to cobble together some code that sort of worked. It seemed like I had a lot of verbose code that didn&#8217;t do much except to get things set&nbsp;up. </p>
<p>As a heavy jQuery user, I kept thinking to myself that the functionality I had could essentially be done in about half the code if I just used jQuery. Sure, it might not have the structure I was searching for, but the question still&nbsp;nagged.</p>
<p><a href="http://jsfiddle.net/9aH2q/5/">This is the code as it stood and was sort of&nbsp;working.</a></p>
<p>The error that I had with this code was that The PostedPiblications data was always one action behind the PostedPubsCampaign selection. That is, if the app loaded with the data for campaign A, then the user changed the selection to campaign B, nothing would happen. I the user then selected campaign C, the PostedPublications shown on the page would belong to campaign&nbsp;B.</p>
<p>I could see that the correct <span class="caps">API</span> call was being made, but the page wasn&#8217;t updating as expected. After fighting for this for a full day, I posted <a href="http://stackoverflow.com/questions/12785996/updating-ember-view-with-change-in-a-select-view">this StackOverflow question that remains unanswered</a> with 40&nbsp;views.</p>
<p>Despite the fact that I had some code that worked moderately well, I still didn&#8217;t really understand why I needed controllers and views. The models didn&#8217;t seem to quite work the way my conception of models does (based on my experiences with Django and Sqlalchemy&nbsp;models).</p>
<h3>Getting&nbsp;Help</h3>
<p>You&#8217;ll notice that I posted a few question on StackOverflow while working through this Ember.js work. I was also in the #emberjs <span class="caps">IRC</span> channel often and asking questions in there. Adding to that numerous Google searches and bugging my coworkers and I was quickly exhausting my supply of&nbsp;resources.</p>
<p>Given the relative newness of Ember.js and the current lack of experienced folks who have built apps with it <span class="caps">AND</span> are willing to help in <span class="caps">IRC</span>, blog, answer <span class="caps">SO</span> questions, etc., it&#8217;s a challenging environment for a newbie. I did just stumble on <a href="http://www.embernoob.com/">EmberNoob</a> and that may grow into a nice&nbsp;resource.</p>
<p>All of this trouble left me frustrated, confused and still staring at a looming&nbsp;deadline.</p>
<h2>Trying out&nbsp;Backbone.js</h2>
<p>At this point, one of my coworkers made the point that we were already using <a href="http://backbonejs.org/">Backbone.js</a> in many other places in our application. Now that I had a good sense of what I wanted to do in the app, it might be easier to learn Backbone instead of&nbsp;Ember.</p>
<p>I took essentially a day and ported the code I had over the Backbone.js and ended up with <a href="https://gist.github.com/3886893">this bit of code</a>.</p>
<p>With this, I couldn&#8217;t get past the point of a syntax error. JSLint wasn&#8217;t helping and no one in the office could figure it out. It was at this point, with 4 days of Ember experimentation and 1 day of Backbone coding, that my deadline pressure started tickling the back of my brain and I had to move on to technologies I already&nbsp;knew.</p>
<h2>Temporary&nbsp;Conclusion</h2>
<p>The tenor of this post might lead you to believe that I don&#8217;t like these two projects and think they aren&#8217;t valuable. Quite the&nbsp;contrary.</p>
<p>Both of these Javascript <span class="caps">MVC</span> frameworks have great promise for me and I intend to find another, perhaps better, situation in which I can learn and use them. I really appreciate the structure and modularity that both projects brought to my&nbsp;code.</p>
<p>I also appreciate that they forced me to think about my Javascript code in ways I previously hadn&#8217;t had to. I like the idea of having the code that gets the data into the <span class="caps">DOM</span> be somewhat transparent to the code that pulls that data from its&nbsp;source.</p>
<p>I&#8217;ll come back around to both Ember.js and Backbone.js&nbsp;again.</p>
<h2>Learnings</h2>
<p>In the course of this work, I learned a good deal about promises and deferreds. Additionally, I was exposed to the beauty that is <a href="http://underscorejs.org/">Underscore.js</a> and <a href="http://momentjs.com/">Moment.js</a>. That progress alone was worth delving into this&nbsp;stuff.</p><p>There are <a href=".././/2012/10/13/javascript-mvc-ember-backbone/#disqus_thread">comments</a>.</p>
                </article>
                
                    
<p class="paginator">
    
    Page 1 / 1
    
</p>

                
            </aside><!-- /#featured -->
            
        
        
        
            </ol><!-- /#posts-list -->
            
            </section><!-- /#content -->
        
    


        <section id="extras" class="body">
        
        
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://aezell.github.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>
                            

                        
                            <li><a href="http://twitter.com/aezellisdead">@aezellisdead</a></li>
                        
                            <li><a href="http://github.com/users/aezell">aezell@github</a></li>
                        
                        </ul>
                </div><!-- /.social -->
        
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-35545050-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>



<script type="text/javascript">
    var disqus_shortname = 'ohmyheart';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

</body>
</html>